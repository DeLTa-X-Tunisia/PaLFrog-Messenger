import{c as y,d as p,r as g,j as e,_ as N,e as w,z as h,a as j,C,R as S,g as k,h as v}from"./index-1a54a5af.js";const E=()=>{const{t:s}=y(),{score:a,level:n,breakdown:t,isCalculating:c,calculateScore:l,improvementTips:d}=p(),[m,r]=g.useState("");g.useEffect(()=>{l();const u=setInterval(()=>{l()},30*60*1e3);return()=>clearInterval(u)},[]),g.useEffect(()=>{r(new Date().toLocaleTimeString())},[a]);const o=()=>{switch(n){case"excellent":return"text-green-500";case"good":return"text-blue-500";case"fair":return"text-yellow-500";case"poor":return"text-orange-500";case"critical":return"text-red-500";default:return"text-gray-500"}},x=()=>{switch(n){case"excellent":return"ðŸ›¡ï¸";case"good":return"âœ…";case"fair":return"âš ï¸";case"poor":return"ðŸ”¶";case"critical":return"ðŸš¨";default:return"ðŸ”"}},i=()=>{switch(n){case"excellent":return"from-green-500 to-green-600";case"good":return"from-blue-500 to-blue-600";case"fair":return"from-yellow-500 to-yellow-600";case"poor":return"from-orange-500 to-orange-600";case"critical":return"from-red-500 to-red-600";default:return"from-gray-500 to-gray-600"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s("security.dashboardTitle")}),e.jsx("button",{onClick:l,disabled:c,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 transition-colors",children:c?s("common.loading"):"ðŸ”„"})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:`w-48 h-48 rounded-full bg-gradient-to-br ${i()} flex items-center justify-center shadow-lg`,children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"text-4xl font-bold",children:a}),e.jsx("div",{className:"text-lg opacity-90",children:"/ 100"})]})}),e.jsx("svg",{className:"absolute inset-0 w-48 h-48 transform -rotate-90",children:e.jsx("circle",{cx:"96",cy:"96",r:"88",stroke:"white",strokeWidth:"4",fill:"none",strokeDasharray:`${a/100*552.92} 552.92`,className:"transition-all duration-1000 ease-out"})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:x()}),e.jsx("span",{className:`text-xl font-semibold ${o()}`,children:s(`security.levels.${n}`)})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:s(`security.descriptions.${n}`)})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(t).map(([u,b])=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1 capitalize",children:s(`security.categories.${u}`)}),e.jsxs("div",{className:`text-lg font-semibold ${b>=80?"text-green-500":b>=60?"text-yellow-500":"text-red-500"}`,children:[b,"%"]})]},u))}),m&&e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-500",children:[s("security.lastUpdated")," ",m]})]}),d.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-yellow-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-yellow-800 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),s("security.improvementTips")]}),e.jsx("div",{className:"space-y-3",children:d.map((u,b)=>e.jsx($,{tip:u,index:b},b))})]}),e.jsx(A,{})]})},$=({tip:s,index:a})=>{const{dismissTip:n,markTipCompleted:t}=p();return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:a+1}),e.jsx("span",{className:"text-yellow-800",children:s})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>t(s),className:"px-3 py-1 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm",children:"âœ“"}),e.jsx("button",{onClick:()=>n(s),className:"px-3 py-1 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors text-sm",children:"âœ•"})]})]})},A=()=>{const{t:s}=y();p.getState();const[a,n]=g.useState([]);return g.useEffect(()=>{N(()=>import("./index-1a54a5af.js").then(t=>t.s),["index-1a54a5af.js","index-3e97f551.css"]).then(t=>{n(t.securityScoreService.getMetrics())})},[]),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s("security.detailedMetrics")}),e.jsx("div",{className:"space-y-4",children:a.map(t=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("span",{className:`text-sm font-semibold ${t.currentValue>=80?"text-green-500":t.currentValue>=60?"text-yellow-500":"text-red-500"}`,children:[t.currentValue,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${t.currentValue>=80?"bg-green-500":t.currentValue>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${t.currentValue}%`}})}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]})},t.id))})]})},T=()=>{const{t:s}=y(),{isEnabled:a,isProcessing:n,enableAI:t,disableAI:c,preferences:l,toggleFeature:d,capabilities:m}=w(),r=o=>{switch(o){case"summarization":return"autoSummarize";case"translation":return"autoTranslation";case"sentiment":return"sentimentAnalysis";case"suggestions":return"smartReplies";case"smartReplies":return"smartReplies";default:return null}};return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["ðŸ¤– ",s("ai.assistantTitle")]}),e.jsxs("button",{onClick:()=>a?c():t(),disabled:n,className:`relative inline-flex items-center w-12 h-6 focus:outline-none ${n?"opacity-50 cursor-wait":""}`,children:[e.jsx("div",{className:`
            w-12 h-6 rounded-full transition-colors duration-200
            ${a?"bg-green-500":"bg-gray-300"}
          `}),e.jsx("div",{className:`
            absolute top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 shadow-sm
            ${a?"transform translate-x-7":"transform translate-x-1"}
          `})]})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(m).map(([o,x])=>{const i=r(o),u=i?l[i]:!1;return e.jsxs("button",{onClick:()=>x&&i&&d(i),disabled:!x,className:`flex items-center space-x-2 p-3 rounded-lg border transition-all duration-200 w-full text-left ${x?u?"bg-green-50 border-green-200 text-green-700 shadow-sm hover:bg-green-100":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50 hover:border-gray-300":"bg-gray-50 border-gray-200 text-gray-400 opacity-50 cursor-not-allowed"}`,children:[e.jsx("span",{children:x&&u?"âœ…":x?"âšª":"âŒ"}),e.jsx("span",{className:"text-sm capitalize font-medium",children:s(`ai.capabilities.${o}`)})]},o)})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s("ai.preferences")}),Object.entries(l).map(([o,x])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:s(`ai.features.${o}`)}),e.jsxs("button",{onClick:()=>d(o),className:"relative inline-block w-10 h-5 focus:outline-none",children:[e.jsx("div",{className:`
                    w-10 h-5 rounded-full transition-colors duration-200
                    ${x?"bg-blue-500":"bg-gray-300"}
                  `}),e.jsx("div",{className:`
                    absolute top-0.5 w-4 h-4 bg-white rounded-full transition-transform duration-200 shadow-sm
                    ${x?"transform translate-x-5":"transform translate-x-0.5"}
                  `})]})]},o))]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsx("p",{className:"text-sm text-blue-700",children:s("ai.privacyNote")})})]}),!a&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:s("ai.enablePrompt")}),e.jsx("button",{onClick:t,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all duration-200",children:s("ai.enableAssistant")})]})]})},R=()=>{const{t:s}=y(),[a,n]=g.useState("qr"),[t,c]=g.useState(""),[l,d]=g.useState(""),[m,r]=g.useState(!1),o=async()=>{r(!0);try{const u=await(await fetch("/api/auth/2fa/generate",{method:"POST",headers:{"Content-Type":"application/json"}})).json();c(u.qrCodeUrl),n("verify")}catch(i){console.error("2FA setup failed:",i),h.error("Erreur lors de la configuration 2FA")}finally{r(!1)}},x=async()=>{r(!0);try{(await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:l})})).ok?h.success(s("security.twoFactorEnabled")):h.error(s("security.invalidCode"))}catch(i){console.error("Verification failed:",i),h.error("Erreur de vÃ©rification")}finally{r(!1)}};return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["ðŸ”’ ",s("security.twoFactorAuth")]}),a==="qr"&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:s("security.scanQRCode")}),e.jsx("button",{onClick:o,disabled:m,className:"px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 transition-colors",children:s(m?"common.loading":"security.enable2FA")})]}),a==="verify"&&t&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:t,alt:"QR Code",className:"mx-auto mb-4 w-48 h-48"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s("security.scanWithAuthenticator")}),e.jsx("input",{type:"text",value:l,onChange:i=>d(i.target.value),placeholder:s("security.enterVerificationCode"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg mb-4 text-center text-xl tracking-widest",maxLength:6}),e.jsx("button",{onClick:x,disabled:m||l.length!==6,className:"w-full px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 transition-colors",children:s(m?"common.loading":"security.verifyAndEnable")})]})]})},O=()=>{const{isEncryptionEnabled:s}=j(),[a,n]=g.useState(!1),[t,c]=g.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),l=r=>{j.setState({isEncryptionEnabled:r}),localStorage.setItem("palfrog-encryption-enabled",JSON.stringify(r)),p.getState().calculateScore()},d=async()=>{c({isOpen:!0,title:"RÃ©gÃ©nÃ©rer les clÃ©s",message:"Attention : La rÃ©gÃ©nÃ©ration des clÃ©s rendra illisibles vos anciens messages chiffrÃ©s. Continuer ?",onConfirm:async()=>{n(!0);try{const{user:r}=k.getState();if(!r)throw new Error("User not authenticated");await v.clearKeys(),await v.initialize(),h.success("ClÃ©s rÃ©gÃ©nÃ©rÃ©es avec succÃ¨s !")}catch(r){h.error("Erreur lors de la rÃ©gÃ©nÃ©ration des clÃ©s"),console.error("Key regeneration failed:",r)}finally{n(!1),c(r=>({...r,isOpen:!1}))}}})},m=async()=>{try{h("FonctionnalitÃ© d'export Ã  implÃ©menter",{icon:"ðŸš§"})}catch{h.error("Erreur lors de l'export des clÃ©s")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(C,{isOpen:t.isOpen,title:t.title,message:t.message,onConfirm:t.onConfirm,onCancel:()=>c(r=>({...r,isOpen:!1})),isDangerous:!0}),e.jsx(E,{}),e.jsx(R,{}),e.jsx(T,{}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ðŸ” SÃ©curitÃ© et Chiffrement"}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Chiffrement de bout en bout"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ProtÃ¨ge vos messages avec un chiffrement AES-256-GCM"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:r=>l(r.target.checked),className:"sr-only"}),e.jsx("div",{className:`w-12 h-6 rounded-full transition-colors duration-200 cursor-pointer ${s?"bg-green-500":"bg-gray-300"}`,onClick:()=>l(!s)}),e.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 pointer-events-none ${s?"transform translate-x-7":"transform translate-x-1"}`})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"RÃ©gÃ©nÃ©rer les clÃ©s"}),e.jsx("p",{className:"text-sm text-gray-500",children:"CrÃ©e de nouvelles clÃ©s de chiffrement"})]}),e.jsx("button",{onClick:d,disabled:a,className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 disabled:opacity-50 transition-colors",children:a?"GÃ©nÃ©ration...":"RÃ©gÃ©nÃ©rer"})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Sauvegarder les clÃ©s"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Exportez vos clÃ©s pour les sauvegarder"})]}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Exporter"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ðŸ”’ ParamÃ¨tres de ConfidentialitÃ©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{id:"profile-visible",label:"Profil visible publiquement",description:"Autoriser les autres utilisateurs Ã  voir votre profil"}),e.jsx(f,{id:"contact-restrictions",label:"Restrictions de contact",description:"N'autoriser que vos contacts Ã  vous envoyer des messages"}),e.jsx(f,{id:"read-receipts",label:"AccusÃ©s de lecture",description:"Afficher quand vous avez lu les messages"})]})]})]})},f=({id:s,label:a,description:n})=>{const[t,c]=S.useState(localStorage.getItem(`palfrog-${s}`)==="true"),l=d=>{c(d),localStorage.setItem(`palfrog-${s}`,d.toString()),p.getState().calculateScore()};return e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:a}),e.jsx("p",{className:"text-sm text-gray-500",children:n})]}),e.jsxs("button",{onClick:()=>l(!t),className:"relative inline-block w-12 h-6 focus:outline-none",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:()=>{},className:"sr-only"}),e.jsx("div",{className:`
          w-12 h-6 rounded-full transition-colors duration-200
          ${t?"bg-green-500":"bg-gray-300"}
        `}),e.jsx("div",{className:`
          absolute top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 shadow-sm
          ${t?"transform translate-x-7":"transform translate-x-1"}
        `})]})]})};export{O as SecuritySettings};
